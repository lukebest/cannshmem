### ä½¿ç”¨æ–¹å¼

#### 1. ç¼–è¯‘é¡¹ç›®

åœ¨ `shmem/` æ ¹ç›®å½•ä¸‹æ‰§è¡Œç¼–è¯‘è„šæœ¬ï¼š

```bash
bash scripts/build.sh
```

#### 2. è¿è¡Œ Dynamic-Tiling ç¤ºä¾‹ç¨‹åº

è¿›å…¥ç¤ºä¾‹ç›®å½•å¹¶æ‰§è¡Œè¿è¡Œè„šæœ¬ï¼š

```bash
cd examples/dynamic_tiling
bash scripts/run.sh [comm_type] [data_type] [test_start_line] [test_collect_rows] [device_list]
```

##### å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | å–å€¼ç¤ºä¾‹ |
|------|------|---------|
| `comm_type` | é€šä¿¡-è®¡ç®—èåˆç®—å­ç±»å‹ | `0`: MATMUL_ALLREDUCE<br>`1`: ALLGATHER_MATMUL<br>`2`: MATMUL_REDUCE_SCATTER |
| `data_type` | æ•°æ®ç±»å‹ | `1`: FP16<br>`27`: BF16 |
| `test_start_line`ï¼ˆå¯é€‰ï¼‰ | æµ‹è¯•èµ·å§‹è¡Œç´¢å¼•ï¼ˆå¯¹åº”`test_shapes.csv`ä¸­çš„è¡Œå·ï¼Œä»0å¼€å§‹ï¼‰<br>éœ€ä¸ `test_collect_rows` ä¸€åŒæŒ‡å®šï¼Œç”¨äºæ€§èƒ½æµ‹è¯• | `0`, `10`, `...` |
| `test_collect_rows`ï¼ˆå¯é€‰ï¼‰ | æ¯æ¬¡é‡‡é›†æ€§èƒ½æ•°æ®çš„æµ‹è¯•ç”¨ä¾‹æ•°é‡ | `5`, `10`, `...` |
| `device_list` | æŒ‡å®šè¿è¡Œçš„è®¾å¤‡ï¼ˆNPUï¼‰ç¼–å·åˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš” | `0,1`, `4,5,6,7` |

> ğŸ“Œ **æ³¨æ„**ï¼š  
> - `rankSize`ç”±`device_list`ä¸­è®¾å¤‡æ•°é‡è‡ªåŠ¨ç¡®å®š
> - ç²¾åº¦æµ‹è¯•é»˜è®¤æŒ‰é¡ºåºæ‰§è¡Œtest_shapes.csvä¸­å®šä¹‰çš„æ‰€æœ‰shape
> - æ€§èƒ½æµ‹è¯•éœ€æŒ‡å®štest_start_lineå’Œtest_collect_rowså‚æ•°ï¼šä»ç¬¬test_start_lineä¸ªshapeå¼€å§‹ï¼Œæ¯æ¬¡é‡‡é›†test_collect_rowsä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ŒæŒç»­æ‰§è¡Œç›´è‡³æ–‡ä»¶æœ«å°¾

##### ç¤ºä¾‹

- **ç²¾åº¦æµ‹è¯•ç¤ºä¾‹**ï¼š  
  ä½¿ç”¨ NPU 0 å’Œ 1ï¼Œè¿è¡Œ **MatMul-AllReduce** ç²¾åº¦æµ‹è¯•ï¼Œæ•°æ®ç±»å‹ä¸ºFP16ï¼Œ`rankSize = 2`ï¼š
  ```bash
  bash scripts/run.sh 0 1 0,1
  ```

- **æ€§èƒ½æµ‹è¯•ç¤ºä¾‹**ï¼š  
  ä½¿ç”¨ NPU 4ã€5ã€6ã€7ï¼Œè¿è¡Œ **AllGather-MatMul** æ€§èƒ½æµ‹è¯•ï¼Œæ•°æ®ç±»å‹ä¸º BF16ï¼Œä» `test_shapes.csv` ç¬¬0è¡Œå¼€å§‹ï¼Œæ¯ 10 ä¸ª shape é‡‡é›†ä¸€æ¬¡ `msprof` æ€§èƒ½æ•°æ®ï¼Œ`rankSize = 4`ï¼š
  ```bash
  bash scripts/run.sh 1 27 0 10 4,5,6,7
  ```

#### 3. é…ç½®è®¡ç®—è§„æ¨¡

çŸ©é˜µè®¡ç®—å‚æ•°ï¼ˆåŒ…æ‹¬ `M`, `K`, `N`, `Transpose A`, `Transpose B`ï¼‰åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ï¼š

```
scripts/test_shapes.csv
```

è¯·æ ¹æ®æµ‹è¯•éœ€æ±‚ä¿®æ”¹è¯¥æ–‡ä»¶ï¼Œæ·»åŠ æˆ–è°ƒæ•´æµ‹è¯•ç”¨ä¾‹çš„è¾“å…¥ç»´åº¦å’Œå±æ€§ã€‚

---

âœ… **æç¤º**ï¼š  
- ç¡®ä¿è®¾å¤‡ç¼–å·æ­£ç¡®ä¸”å¯ç”¨ã€‚  
- å»ºè®®åœ¨æ€§èƒ½æµ‹è¯•å‰æ¸…ç†æ— å…³è¿›ç¨‹ï¼Œä»¥ä¿è¯æ•°æ®å‡†ç¡®æ€§ã€‚  
- æ€§èƒ½æ•°æ®é»˜è®¤è¾“å‡ºè‡³ `output/` ç›®å½•ã€‚
